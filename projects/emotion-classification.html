<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotion Classification - Thijn Bakker</title>
    <meta name="description" content="Emotion Classification project showcasing data science and AI skills">
    <meta name="author" content="Thijn Bakker">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/images/icons/cloud_icon.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/components.css">
    <link rel="stylesheet" href="../assets/css/projects.css">
</head>
<body>
    <div class="bg-animation"></div>

    <!-- Navigation -->
    <nav id="navbar">
        <div class="nav-container">
            <a href="../index.html" class="logo">Thijn Bakker</a>
            <ul class="nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../index.html#about">About</a></li>
                <li><a href="../index.html#projects">Projects</a></li>
                <li><a href="../index.html#contact">Contact</a></li>
            </ul>
        </div>
    </nav>

<!-- Project Hero -->
    <section class="project-hero">
        <div class="project-hero-content">
            <h1 class="hero-text">
                <span class="icon-mask" style="--icon-url: url('/assets/images/icons/cloud_icon.svg');"></span>
                Emotion Classification from Video Dialogue
            </h1>
            <p class="project-date">February 2025 - April 2025</p>
            <p class="project-client">Client: 
                <a href="https://www.contentintelligence.nl" target="_blank" style="color: var(--secondary);">Content Intelligence Agency (CIA)</a>
            </p>
            <p class="project-members">Team Members: 
                <a href="https://www.linkedin.com/in/m-simons" target="_blank" style="color: var(--secondary);">Martin Simons</a>
                <a href="https://www.linkedin.com/in/teun-van-der-wolf-08974221b" target="_blank" style="color: var(--secondary);">Teun van der Wolf</a> 
            </p>
        </div>
    </section>

    <!-- Project Content -->
    <section class="project-content">
        <div class="project-container">
            
            <!-- Project Overview -->
            <div class="project-section">
                <h2>Project Overview</h2>
                <p>
                    Developed a comprehensive NLP pipeline for the Content Intelligence Agency to process German video content and classify emotions at the sentence level. Working with multiple datasets including German emotion corpora, MELD, and GoEmotions, we built and compared various models from classical ML to transformer architectures, ultimately achieving our best performance with BERT models trained on English data and mapped to 8 emotion categories including curiosity.
                </p>
            </div>

            <!-- The Challenge -->
            <div class="project-section">
                <h2>The Challenge</h2>
                <p>
                    The Content Intelligence Agency needed to analyze German video content with unique challenges that emerged during the project:
                </p>
                <p>
                    • Processing transcribed German dialogue from unscripted videos<br>
                    • Handling severe class imbalance in emotion datasets (neutral: 47%, surprise: 3%)<br>
                    • Mapping complex emotions like curiosity to traditional Ekman taxonomy<br>
                    • Dealing with translation quality issues affecting emotion preservation<br>
                    • Comparing German vs English model performance across different datasets<br>
                    • Creating explainable predictions despite transformer model complexity
                </p>
            </div>

            <!-- My Approach -->
            <div class="project-section">
                <h2>My Approach</h2>
                <p>
                    I designed a systematic approach testing multiple model architectures across different datasets:
                </p>
                <p>
                    <strong>1. Multi-Dataset Strategy:</strong> Combined German emotion datasets (24,067 samples), MELD (12,599 samples), and GoEmotions (69,914 samples)<br>
                    <strong>2. Progressive Model Development:</strong> Started with baseline models (Naive Bayes, Logistic Regression) before advancing to deep learning<br>
                    <strong>3. Neural Network Evolution:</strong> Implemented bidirectional RNNs and LSTMs with dropout, L2 regularization, and batch normalization<br>
                    <strong>4. Transformer Implementation:</strong> Fine-tuned BERT models with class weights and WordNet-based data augmentation<br>
                    <strong>5. Cross-language Analysis:</strong> Systematically compared German vs English model performance to optimize architecture choice
                </p>
            </div>

            <!-- Technical Implementation -->
            <div class="project-section">
                <h2>Technical Implementation</h2>
                <p>
                    The final pipeline evolved through systematic testing of multiple approaches:
                </p>
                
                <pre><code>
# BERT Pipeline - Best Performing Model
class EmotionClassificationPipeline:
    def __init__(self):
        # Transcription comparison results
        self.transcriber = WhisperModel()  # WER: 2.28% (beat AssemblyAI: 2.83%)
        
        # Translation with quality monitoring
        self.translator = MarianMTModel('Helsinki-NLP/opus-mt-de-en')
        # BLEU scores: 27.4% - 55.4% (variable quality)
        
        # Best performing BERT configuration
        self.emotion_model = BertForSequenceClassification.from_pretrained(
            'bert-base-uncased',
            num_labels=8  # Added curiosity as 8th emotion
        )
        
        # Class weights for severe imbalance
        self.class_weights = self.calculate_class_weights()
        
    def train_with_augmentation(self, dataset):
        # Data augmentation with WordNet synonyms for minority classes
        augmented_data = self.augment_minority_classes(dataset)
        
        # Training with callbacks
        trainer = Trainer(
            model=self.emotion_model,
            callbacks=[
                EarlyStopping(patience=3),
                ReduceLROnPlateau(factor=0.5),
                ModelCheckpoint(save_best_only=True)
            ]
        )
        
        return trainer.train(augmented_data)
    
    def explain_prediction(self, text, prediction):
        # XAI methods implemented
        gradient_analysis = self.gradient_input_analysis(text)
        perturbation_results = self.perturbation_analysis(text)
        
        return {
            'prediction': prediction,
            'gradient_importance': gradient_analysis,
            'confidence_sensitivity': perturbation_results
        }
                </code></pre>

                <p>
                    <strong>Critical Discoveries:</strong><br>
                    • English models significantly outperformed German models across all architectures<br>
                    • Manual validation showed 80-90% accuracy vs 56% automated evaluation<br>
                    • Translation errors like "einen an der Waffel haben" → "has one on the waffle" impacted performance<br>
                    • Curiosity mapping to happiness proved problematic, leading to 8-emotion framework<br>
                    • Company pipeline itself achieved only 71% accuracy against ground truth labels
                </p>
            </div>

            <!-- Results & Impact -->
            <div class="project-section">
                <h2>Results & Impact</h2>
                <p>
                    The emotion classification system revealed important insights about model evaluation and real-world performance:
                </p>
                <p>
                    • <strong>Best Model Performance:</strong> BERT achieved 79.8% accuracy and 79.2% F1 score on validation data<br>
                    • <strong>Company Pipeline Evaluation:</strong> 56% F1 score against automated labels, revealing evaluation challenges<br>
                    • <strong>Manual Review Results:</strong> 80-90% accuracy when predictions were manually validated<br>
                    • <strong>Transcription Benchmarking:</strong> Whisper achieved 2.28% WER vs AssemblyAI's 2.83%<br>
                    • <strong>8-Emotion Framework:</strong> Successfully expanded beyond Ekman's 6 emotions to include curiosity<br>
                    • <strong>Cross-language Insights:</strong> English models consistently outperformed German models due to pre-training advantages<br>
                    • <strong>Translation Quality Impact:</strong> BLEU scores of 27.4%-55.4% highlighted the challenge of preserving emotional nuance
                </p>
                <p>
                    The project highlighted the critical importance of evaluation methodology in emotion classification tasks, showing that automated metrics don't always reflect real-world model performance and that subjective emotion mapping creates significant evaluation challenges.
                </p>
            </div>

            <!-- Key Learnings -->
            <div class="project-section">
                <h2>Key Learnings</h2>
                <p>
                    <strong>Evaluation Methodology Matters:</strong> The biggest insight was that our BERT model performed much better than metrics suggested. Manual review showed 80-90% accuracy while automated evaluation against the company pipeline showed only 56% F1 score, highlighting fundamental issues with the emotion mapping process from fine-grained to broad categories.
                </p>
                <p>
                    <strong>English vs German Model Performance:</strong> English-trained transformer models significantly outperformed German models across all architectures, likely because BERT and RoBERTa are pre-trained on large English corpora. This suggests the value of leveraging strong English pre-training even for German tasks, despite translation overhead.
                </p>
                <p>
                    <strong>Emotion Taxonomy Challenges:</strong> Mapping complex emotions like curiosity to Ekman's 6 basic emotions proved problematic. Questions like "What are you looking for today?" could express happiness, fear, surprise, or sadness depending on context, leading us to add curiosity as an 8th emotion category.
                </p>
                <p>
                    <strong>Translation Quality Impact:</strong> BLEU scores ranging from 27.4% to 55.4% revealed significant translation challenges, especially with German idioms like "einen an der Waffel haben" being mistranslated as "has one on the waffle" instead of "totally nuts," demonstrating how cultural context gets lost in translation.
                </p>
                <p>
                    <strong>Subjectivity in Ground Truth:</strong> Even the company's own pipeline achieved only 71% accuracy against manual ground truth labels, highlighting the inherent subjectivity in emotion classification and the importance of careful evaluation design.
                </p>
            </div>

            <!-- Project Presentation -->
            <div class="project-section">
                <h2>Project Presentation</h2>
                <p>Here's the comprehensive presentation I delivered on the Emotion Classification project, covering the NLP pipeline development, model comparisons, and evaluation methodology challenges:</p>
                
                <div class="presentation-slider">
                    <div class="slide-container">
                        <div class="slide active">
                            <img src="../presentations/emotion-classification/Slide1.PNG" alt="Emotion Classification Presentation - Slide 1">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide2.PNG" alt="Emotion Classification Presentation - Slide 2">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide3.PNG" alt="Emotion Classification Presentation - Slide 3">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide4.PNG" alt="Emotion Classification Presentation - Slide 4">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide5.PNG" alt="Emotion Classification Presentation - Slide 5">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide6.PNG" alt="Emotion Classification Presentation - Slide 6">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide7.PNG" alt="Emotion Classification Presentation - Slide 7">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide8.PNG" alt="Emotion Classification Presentation - Slide 8">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide9.PNG" alt="Emotion Classification Presentation - Slide 9">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide10.PNG" alt="Emotion Classification Presentation - Slide 10">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide11.PNG" alt="Emotion Classification Presentation - Slide 11">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide12.PNG" alt="Emotion Classification Presentation - Slide 12">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide13.PNG" alt="Emotion Classification Presentation - Slide 13">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide14.PNG" alt="Emotion Classification Presentation - Slide 14">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide15.PNG" alt="Emotion Classification Presentation - Slide 15">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide16.PNG" alt="Emotion Classification Presentation - Slide 16">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide17.PNG" alt="Emotion Classification Presentation - Slide 17">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide18.PNG" alt="Emotion Classification Presentation - Slide 18">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide19.PNG" alt="Emotion Classification Presentation - Slide 19">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide20.PNG" alt="Emotion Classification Presentation - Slide 20">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide21.PNG" alt="Emotion Classification Presentation - Slide 21">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide22.PNG" alt="Emotion Classification Presentation - Slide 22">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide23.PNG" alt="Emotion Classification Presentation - Slide 23">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide24.PNG" alt="Emotion Classification Presentation - Slide 24">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide25.PNG" alt="Emotion Classification Presentation - Slide 25">
                        </div>
                        <div class="slide">
                            <img src="../presentations/emotion-classification/Slide26.PNG" alt="Emotion Classification Presentation - Slide 26">
                        </div>
                    </div>
                    
                    <div class="slide-navigation">
                        <button class="nav-btn prev-btn" onclick="changeSlide(-1)">‹</button>
                        <span class="slide-counter">
                            <span class="current-slide">1</span> / <span class="total-slides">26</span>
                        </span>
                        <button class="nav-btn next-btn" onclick="changeSlide(1)">›</button>
                    </div>
                    
                    <div class="slide-indicators">
                        <button class="indicator active" onclick="currentSlide(1)"></button>
                        <button class="indicator" onclick="currentSlide(2)"></button>
                        <button class="indicator" onclick="currentSlide(3)"></button>
                        <button class="indicator" onclick="currentSlide(4)"></button>
                        <button class="indicator" onclick="currentSlide(5)"></button>
                        <button class="indicator" onclick="currentSlide(6)"></button>
                        <button class="indicator" onclick="currentSlide(7)"></button>
                        <button class="indicator" onclick="currentSlide(8)"></button>
                        <button class="indicator" onclick="currentSlide(9)"></button>
                        <button class="indicator" onclick="currentSlide(10)"></button>
                        <button class="indicator" onclick="currentSlide(11)"></button>
                        <button class="indicator" onclick="currentSlide(12)"></button>
                        <button class="indicator" onclick="currentSlide(13)"></button>
                        <button class="indicator" onclick="currentSlide(14)"></button>
                        <button class="indicator" onclick="currentSlide(15)"></button>
                        <button class="indicator" onclick="currentSlide(16)"></button>
                        <button class="indicator" onclick="currentSlide(17)"></button>
                        <button class="indicator" onclick="currentSlide(18)"></button>
                        <button class="indicator" onclick="currentSlide(19)"></button>
                        <button class="indicator" onclick="currentSlide(20)"></button>
                        <button class="indicator" onclick="currentSlide(21)"></button>
                        <button class="indicator" onclick="currentSlide(22)"></button>
                        <button class="indicator" onclick="currentSlide(23)"></button>
                        <button class="indicator" onclick="currentSlide(24)"></button>
                        <button class="indicator" onclick="currentSlide(25)"></button>
                        <button class="indicator" onclick="currentSlide(26)"></button>
                    </div>
                </div>
            </div>

            <!-- Technologies Used -->
            <div class="project-section">
                <h2>Technologies Used</h2>
                <div class="tech-grid">
                    <span class="tech-tag">Python</span>
                    <span class="tech-tag">BERT</span>
                    <span class="tech-tag">RoBERTa</span>
                    <span class="tech-tag">HuggingFace</span>
                    <span class="tech-tag">PyTorch</span>
                    <span class="tech-tag">Bidirectional LSTM</span>
                    <span class="tech-tag">Bidirectional RNN</span>
                    <span class="tech-tag">scikit-learn</span>
                    <span class="tech-tag">NLTK</span>
                    <span class="tech-tag">spaCy</span>
                    <span class="tech-tag">Whisper</span>
                    <span class="tech-tag">AssemblyAI</span>
                    <span class="tech-tag">Helsinki-NLP</span>
                    <span class="tech-tag">WordNet</span>
                    <span class="tech-tag">XAI</span>
                    <span class="tech-tag">Gradient Analysis</span>
                    <span class="tech-tag">Perturbation Analysis</span>
                </div>
            </div>

        </div>
    </section>

    <!-- Back to Projects -->
    <section class="back-navigation">
        <a href="../index.html#projects" class="btn btn-secondary">← Back to Projects</a>
    </section>

    <!-- Footer -->
    <footer>
        <p>&copy; 2025 Thijn Bakker. Built with passion and lots of coffee ☕</p>
    </footer>

    <!-- JavaScript -->
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/components/slider.js"></script>
    <script src="../assets/js/components/paper-viewer.js"></script>
</body>
</html>